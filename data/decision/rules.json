{
  "version": "0.1.0",
  "inputs_schema": {
    "data_classification": [
      "public",
      "internal",
      "restricted",
      "cjis",
      "phi"
    ],
    "internet_exposed": [
      true,
      false
    ],
    "hybrid_required": [
      true,
      false
    ],
    "rto_tier": [
      "high",
      "medium",
      "low"
    ]
  },
  "rules": [
    {
      "rule_id": "req.cjis.baseline",
      "when": {
        "data_classification": [
          "cjis"
        ]
      },
      "require_capabilities": [
        "iot_security.logging"
      ],
      "recommend_patterns": [
        "core.landing_zone.v1"
      ],
      "reason": "CJIS workloads require strong identity, auditing/logging, encryption, and threat detection baselines."
    },
    {
      "rule_id": "pref.internet.edge",
      "when": {
        "internet_exposed": [
          true
        ]
      },
      "recommend_patterns": [
        "sec.edge_protection.v1"
      ],
      "score_boost": {
        "pattern": "sec.edge_protection.v1",
        "boost": 30
      },
      "reason": "Internet-exposed apps should use edge acceleration and protection (CDN/WAF/DDoS)."
    },
    {
      "rule_id": "req.hybrid.connectivity",
      "when": {
        "hybrid_required": [
          true
        ]
      },
      "recommend_patterns": [
        "net.private_connectivity.v1"
      ],
      "score_boost": {
        "pattern": "net.private_connectivity.v1",
        "boost": 25
      },
      "reason": "Hybrid environments require dedicated/VPN/private connectivity and DNS/segmentation patterns."
    },
    {
      "rule_id": "pref.high_rto",
      "when": {
        "rto_tier": [
          "high"
        ]
      },
      "score_boost": {
        "pattern": "core.landing_zone.v1",
        "boost": 10
      },
      "reason": "Higher availability targets increase value of a standardized landing zone and observability/security foundations."
    }
  ]
}